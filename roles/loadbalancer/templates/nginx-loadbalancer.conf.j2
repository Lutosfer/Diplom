upstream mediawiki_backend {
    server {{ hostvars['web01']['ansible_host'] }}:8080 weight=1 max_fails=3 fail_timeout=30s;
    server {{ hostvars['web02']['ansible_host'] }}:8080 weight=1 max_fails=3 fail_timeout=30s;
    
    least_conn;
    keepalive 32;
}

server {
    listen 8080;
    server_name _;

    client_max_body_size 64M;

    location / {
        proxy_pass http://mediawiki_backend;
	}
}
